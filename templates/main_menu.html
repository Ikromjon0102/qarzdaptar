{% extends 'base.html' %}

{% block content %}
<div class="d-flex flex-column justify-content-center min-vh-75">


<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="fw-bold mb-0 text-dark">{{ shop.name }}</h2>

        <p class="text-muted small m-0 text-dark">
            <i class="fa-solid fa-user-tie me-1"></i>
            {{ request.user.first_name|default:request.user.username }}

            {% if request.user.profile.role == 'admin' %}
                <span class="badge bg-warning text-dark ms-1" style="font-size: 0.7em;">RAHBAR</span>
            {% elif request.user.profile.role == 'worker' %}
                <span class="badge bg-secondary ms-1" style="font-size: 0.7em;">XODIM</span>
            {% else %}
                <span class="badge bg-light text-muted border ms-1" style="font-size: 0.7em;">MEHMON</span>
            {% endif %}
        </p>
    </div>

<!--    <a href="{% url 'login_page' %}" class="btn btn-light shadow-sm rounded-circle text-danger">-->
<!--        <i class="fa-solid fa-right-from-bracket"></i>-->
<!--    </a>-->
</div>

    <div class="row g-3">
        <div class="col-6">
            <a href="{% url 'create_debt' %}" class="btn-menu bg-primary text-white">
                <i class="fa-solid fa-cart-plus fa-2x mb-2"></i>
                <span>Nasiya Yozish</span>
            </a>
        </div>

        <div class="col-6">
            <a href="{% url 'dashboard' %}" class="btn-menu bg-success text-white">
                <i class="fa-solid fa-users fa-2x mb-2"></i>
                <span>Dashboard</span>
            </a>
        </div>

        <div class="col-6">
            <a href="{% url 'create_payment' %}" class="btn-menu bg-warning text-dark">
                <i class="fa-solid fa-hand-holding-dollar fa-2x mb-2"></i>
                <span>To'lov Olish</span>
            </a>
        </div>

        <div class="col-6">
            <a href="{% url 'settings' %}" class="btn-menu bg-secondary text-white">
                <i class="fa-solid fa-gear fa-2x mb-2"></i>
                <span>Sozlamalar</span>
            </a>
        </div>

        <div class="col-6">
            <a href="{% url 'broadcast' %}" class="btn-menu bg-indigo text-white">
                <i class="fa-solid fa-paper-plane fa-2x mb-2"></i>
                <span>Xabar yuborish</span>
            </a>
        </div>

        <div class="col-6">
            <a href="{% url 'admin_control' %}" class="btn-menu bg-dark text-white">
                <i class="fa-solid fa-users-gear fa-2x mb-2"></i>
                <span>Adminlar</span>
            </a>
        </div>
        <div class="col-6 text-dark">
            <a href="{% url 'client_add' %}" class="btn-menu bg-google text-white">
                <i class="fa-solid fa-users fa-2x mb-2 text-dark"></i>
                <span class=" text-dark">Mijoz qo'shish</span>
            </a>
        </div>
        <div class="col-6 text-dark">
            <a href="{% url 'reports_page' %}" style="background: linear-gradient(135deg, #20c997 0%, #0f7a63 100%);" class="btn-menu bg-google text-white">
                <i class="fa-solid fa-chart-pie fa-2x mb-2"></i>
                <span class="text-dark">Hisobotlar</span>
            </a>
        </div>

<!--        <div class="col-6 mb-3">-->
<!--            <a href="" class="card shadow-sm border-0 text-decoration-none h-100"-->
<!--               style="background: linear-gradient(135deg, #20c997 0%, #0f7a63 100%);"> <div class="card-body text-center text-white d-flex flex-column justify-content-center align-items-center p-3">-->

<!--                    <h6 class="fw-bold m-0" style="font-size: 0.9rem;"></h6>-->
<!--                </div>-->
<!--            </a>-->
<!--        </div>-->

    </div>
</div>

<style>
    /* Sizning stillaringiz... */
    .btn-menu {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        border-radius: 20px;
        text-decoration: none;
        height: 140px;
        transition: transform 0.2s ease-in-out;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        border: none;
    }
    .btn-menu:hover {
        transform: scale(1.03);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        color: inherit;
    }
    .btn-menu:active {
        transform: scale(0.95);
    }
    .btn-menu span {
        font-weight: 600;
        font-size: 0.9rem;
        margin-top: 5px;
    }
    .bg-indigo {
        background-color: #6610f2 !important;
    }
    .bg-google {
        background-color: #1b6d85 !important;
    }
</style>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // 1. Agar user Telegram orqali kirgan bo'lsa
    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {

        // Bu userning Telegram ID si
        const currentTgId = String(tg.initDataUnsafe.user.id);

        // Django (Baza) dagi userning Telegram ID si (Agar modelda bor bo'lsa)
        // Agar sizda user modelida 'telegram_id' bo'lmasa, buni ishlatish qiyinroq.
        // Hozircha oddiy yechim:

        console.log("Telegram User:", currentTgId);
    }

    // Agar Telegramdan kirilgan bo'lsa, lekin Serverda AnonymousUser bo'lsa
    // Yoki Serverdagi sessiya boshqa odamniki bo'lib qolgan bo'lsa
    // Buni backendda tekshirish ishonchliroq, lekin frontda Logout tugmasi borligi yaxshi.
</script>

{% endblock %}
